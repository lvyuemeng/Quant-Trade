{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.4"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "da3a3678a0a4d87af643831b2141b4cb",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "532b5a0f3c4c608d50af6d413a3faff4",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "The following columns were not found: ['Date']\n\nHint: Did you mean one of these columns: []?",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_pandas_like\\expr.py&quot;</span>, line <span class=\"m\">160</span>, in <span class=\"n\">func</span>\n<span class=\"w\">    </span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">_native_frame</span><span class=\"p\">[</span><span class=\"n\">column_name</span><span class=\"p\">],</span>\n<span class=\"w\">    </span><span class=\"pm\">~~~~~~~~~~~~~~~~^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\pandas\\core\\frame.py&quot;</span>, line <span class=\"m\">4113</span>, in <span class=\"n\">__getitem__</span>\n<span class=\"w\">    </span><span class=\"n\">indexer</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">columns</span><span class=\"o\">.</span><span class=\"n\">get_loc</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\pandas\\core\\indexes\\range.py&quot;</span>, line <span class=\"m\">417</span>, in <span class=\"n\">get_loc</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">)</span>\n<span class=\"gr\">KeyError</span>: <span class=\"n\">&#39;Date&#39;</span>\n\n<span class=\"gt\">The above exception was the direct cause of the following exception:</span>\n\n<span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\marimo\\_runtime\\executor.py&quot;</span>, line <span class=\"m\">138</span>, in <span class=\"n\">execute_cell</span>\n<span class=\"w\">    </span><span class=\"n\">exec</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"pm\">~~~~^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;F:\\Stratum\\TEMP\\marimo_18388\\__marimo__cell_MJUe_.py&quot;</span>, line <span class=\"m\">1</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">get_stock_data</span><span class=\"p\">(</span><span class=\"s2\">&quot;000001&quot;</span><span class=\"p\">,</span> <span class=\"n\">adjust</span><span class=\"o\">=</span><span class=\"s2\">&quot;qfq&quot;</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\marimo\\_save\\save.py&quot;</span>, line <span class=\"m\">436</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">e</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\marimo\\_save\\save.py&quot;</span>, line <span class=\"m\">430</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">__wrapped__</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;C:\\Users\\nostalgia\\proj\\Course\\quant-trade\\notebooks\\utils\\data.py&quot;</span>, line <span class=\"m\">24</span>, in <span class=\"n\">get_stock_data</span>\n<span class=\"w\">    </span><span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">with_columns</span><span class=\"p\">(</span>\n<span class=\"w\">         </span><span class=\"pm\">~~~~~~~~~~~~~~~^</span>\n<span class=\"w\">    </span>    <span class=\"n\">Date</span><span class=\"o\">=</span><span class=\"n\">nw</span><span class=\"o\">.</span><span class=\"n\">col</span><span class=\"p\">(</span><span class=\"s2\">&quot;Date&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">str</span><span class=\"o\">.</span><span class=\"n\">to_date</span><span class=\"p\">(),</span>\n<span class=\"w\">        </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n<span class=\"w\">    </span><span class=\"o\">...&lt;</span><span class=\"mi\">3</span> <span class=\"n\">lines</span><span class=\"o\">&gt;...</span>\n<span class=\"w\">    </span>    <span class=\"o\">.</span><span class=\"n\">otherwise</span><span class=\"p\">(</span><span class=\"n\">nw</span><span class=\"o\">.</span><span class=\"n\">lit</span><span class=\"p\">(</span><span class=\"s2\">&quot;#00B800&quot;</span><span class=\"p\">)),</span>\n<span class=\"w\">        </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n<span class=\"w\">    </span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">sort</span><span class=\"p\">(</span><span class=\"s2\">&quot;Date&quot;</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"pm\">^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\dataframe.py&quot;</span>, line <span class=\"m\">1502</span>, in <span class=\"n\">with_columns</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">with_columns</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">exprs</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">named_exprs</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\dataframe.py&quot;</span>, line <span class=\"m\">214</span>, in <span class=\"n\">with_columns</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_with_compliant</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_compliant_frame</span><span class=\"o\">.</span><span class=\"n\">with_columns</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">compliant_exprs</span><span class=\"p\">))</span>\n<span class=\"w\">                                </span><span class=\"pm\">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_pandas_like\\dataframe.py&quot;</span>, line <span class=\"m\">498</span>, in <span class=\"n\">with_columns</span>\n<span class=\"w\">    </span><span class=\"n\">columns</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_evaluate_exprs</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">exprs</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\dataframe.py&quot;</span>, line <span class=\"m\">367</span>, in <span class=\"n\">_evaluate_exprs</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">chain</span><span class=\"o\">.</span><span class=\"n\">from_iterable</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_evaluate_expr</span><span class=\"p\">(</span><span class=\"n\">expr</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">expr</span> <span class=\"ow\">in</span> <span class=\"n\">exprs</span><span class=\"p\">))</span>  <span class=\"c1\"># pyright: ignore[reportArgumentType]</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\dataframe.py&quot;</span>, line <span class=\"m\">367</span>, in <span class=\"n\">&lt;genexpr&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">chain</span><span class=\"o\">.</span><span class=\"n\">from_iterable</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_evaluate_expr</span><span class=\"p\">(</span><span class=\"n\">expr</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">expr</span> <span class=\"ow\">in</span> <span class=\"n\">exprs</span><span class=\"p\">))</span>  <span class=\"c1\"># pyright: ignore[reportArgumentType]</span>\n<span class=\"w\">                                     </span><span class=\"pm\">~~~~~~~~~~~~~~~~~~~^^^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\dataframe.py&quot;</span>, line <span class=\"m\">380</span>, in <span class=\"n\">_evaluate_expr</span>\n<span class=\"w\">    </span><span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">expr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\expr.py&quot;</span>, line <span class=\"m\">247</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_call</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">~~~~~~~~~~^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\expr.py&quot;</span>, line <span class=\"m\">651</span>, in <span class=\"n\">&lt;lambda&gt;</span>\n<span class=\"w\">    </span><span class=\"k\">lambda</span> <span class=\"n\">df</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">series</span><span class=\"o\">.</span><span class=\"n\">alias</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">series</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)],</span>\n<span class=\"w\">                                                 </span><span class=\"pm\">~~~~^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\expr.py&quot;</span>, line <span class=\"m\">247</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_call</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">~~~~~~~~~~^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\expr.py&quot;</span>, line <span class=\"m\">413</span>, in <span class=\"n\">inner</span>\n<span class=\"w\">    </span><span class=\"k\">for</span> <span class=\"n\">series</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)</span>\n<span class=\"w\">                  </span><span class=\"pm\">~~~~^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_compliant\\expr.py&quot;</span>, line <span class=\"m\">247</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_call</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">~~~~~~~~~~^^^^</span>\n  File <span class=\"nb\">&quot;E:\\Proj\\Course\\quant-trade\\.venv\\Lib\\site-packages\\narwhals\\_pandas_like\\expr.py&quot;</span>, line <span class=\"m\">168</span>, in <span class=\"n\">func</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">error</span> <span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">e</span>\n<span class=\"gr\">narwhals.exceptions.ColumnNotFoundError</span>: <span class=\"n\">The following columns were not found: [&#39;Date&#39;]</span>\n\n<span class=\"x\">Hint: Did you mean one of these columns: []?</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "vblA",
      "code_hash": "f6648bdcc9cd5a05de7c0d2c2df46334",
      "outputs": [],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "1dbff91ea97afa5420be0bbdd61997f9",
      "outputs": [],
      "console": []
    }
  ]
}